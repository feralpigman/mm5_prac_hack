bank $08

// warps to the stage select, but warping after D4 messes up stage select
// can still select successfully
org $BD06
	LDX #$00
  .setStageSelectLoop1:
	LDA .stage_select_ram1, x
	STA $00, x
	INX
	CPX #$00
	BNE .setStageSelectLoop1
  .setStageSelectLoop2:
	LDA .stage_select_ram2, x
	STA $0100, x
	INX
	CPX #$00
	BNE .setStageSelectLoop2
  .stageSelectDone:
	LDA #$AF
	STA $0200
	LDA #$07
	LDX #$04
	LDY #$08
	JMP $F80E
	
  .stage_select_ram1:
	db $02, $00, $FF, $00, $00, $00, $00, $00, $02, $00, $05, $00, $00, $F0, $04, $F0 // $000
	db $00, $00, $C4, $7F, $80, $00, $80, $00, $00, $00, $00, $00, $00, $00, $00, $00 // $010
	db $40, $B6, $00, $01, $12, $00, $10, $0F, $01, $00, $02, $00, $01, $00, $00, $00 // $020
	db $07, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00 // $030
	db $02, $00, $00, $00, $18, $D5, $00, $01, $00, $00, $00, $00, $00, $00, $00, $00 // $040
	db $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00 // $050
	db $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $04, $10, $00, $00 // $060
	db $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00 // $070
	db $00, $00, $DB, $DE, $01, $01, $AB, $DB, $02, $00, $89, $DD, $00, $00, $00, $00 // $080
	db $00, $02, $3C, $01, $DB, $00, $01, $76, $C2, $00, $00, $88, $88, $9F, $FF, $78 // $090
	db $00, $40, $00, $00, $00, $00, $18, $F9, $03, $00, $00, $FF, $01, $30, $2D, $00 // $0A0
	db $80, $00, $00, $00, $00, $00, $00, $00, $00, $00, $9C, $00, $00, $08, $84, $02 // $0B0
	db $00, $00, $05, $00, $03, $7B, $8B, $01, $BC, $01, $4C, $00, $00, $00, $00, $00 // $0C0
	db $00, $00, $00, $00, $FF, $00, $00, $00, $00, $13, $05, $05, $88, $88, $88, $88 // $0D0
	db $88, $88, $88, $88, $0F, $97, $88, $A7, $B8, $FE, $D0, $D2, $00, $00, $08, $00 // $0E0
	db $00, $1C, $07, $17, $0C, $17, $0C, $00, $00, $00, $00, $00, $00, $00, $18, $88 // $0F0
  .stage_select_ram2:	
	db $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00 // $100
	db $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00 // $110
	db $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00 // $120
	db $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00 // $130
	db $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00 // $140
	db $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00 // $150
	db $00, $00, $00, $00, $00, $00, $00, $00, $00, $03, $8A, $03, $AB, $07, $03, $0A // $160
	db $A6, $02, $A3, $80, $00, $A3, $80, $00, $A3, $80, $00, $00, $A8, $FF, $61, $C1 // $170
	db $48, $00, $00, $32, $9B, $2C, $FF, $FF, $2C, $FF, $80, $FF, $67, $85, $22, $DE // $180
	db $00, $00, $00, $00, $00, $00, $00, $00, $00, $0B, $09, $05, $8A, $06, $8A, $88 // $190
	db $AE, $83, $A3, $00, $00, $00, $36, $22, $15, $04, $2C, $FF, $00, $00, $68, $DB // $1A0
	db $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $7F // $1B0
	db $08, $9F, $88, $85, $8A, $88, $AE, $FC, $81, $28, $A7, $3E, $6D, $A3, $80, $00 // $1C0
	db $03, $A8, $FF, $61, $02, $00, $00, $87, $75, $9B, $05, $FF, $0D, $FF, $B3, $DE // $1D0
	db $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $FC, $08, $9F, $88 // $1E0
	db $BE, $83, $A3, $80, $00, $00, $A8, $FF, $61, $C1, $03, $04, $01, $B0, $B7, $FE // $1F0
	
// check menu input and act accordingly
org $BF40
	// if select, jump to stage select	
	CMP #$20
	BEQ stageSelect
	// otherwise continue as normal
returnToWeaponSelect:
	JMP $8140
useMtank:
	// set mtank to 1 first
	PHA
	LDA #$81
	STA $BE
	PLA
	JMP $8164
stageSelect:
	JMP $BD06
